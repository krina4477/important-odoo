<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <record id="view_stock_move_line_operation_tree_extended" model="ir.ui.view">
        <field name="name">stock.move.line.operations.tree.extended</field>
        <field name="model">stock.move.line</field>
        <field name="inherit_id" ref="stock.view_stock_move_line_operation_tree"/>
        <field name="arch" type="xml">
            <field name="lot_id" position="before">
                <field name="picking_code" invisible="1"/>
                <field name="cartoon_lot_ids" invisible="1"/>
                <field name="truck_id" invisible="1" force_save="1"/>
                <field name="sale_truck_id" attrs="{'column_invisible': ['|', ('parent.is_return_order', '=', True), ('parent.picking_code', '=', 'incoming')]}" domain="[('location_dest_id', '=', location_id), ('id', '!=', truck_id), ('cartoon_ids.move_line_ids.product_id', '=', product_id), ('picking_code', 'in', ['incoming', 'internal'])]"/>
                <field name="from_cartoon_number" attrs="{'column_invisible': ['|', ('parent.is_return_order', '=', True), ('parent.picking_code', '=', 'incoming')]}" domain="[('truck_id', '=', sale_truck_id), ('move_line_ids.product_id', '=', product_id), ('truck_id.picking_code', 'in', ['incoming', 'internal'])]"/>
                <field name="purchase_return_truck_id" attrs="{'column_invisible': ['|', ('parent.is_return_order', '=', False), ('parent.picking_code', '=', 'incoming')]}" domain="[('cartoon_ids.move_line_ids.product_id', '=', product_id), ('picking_code', '=', 'incoming'), ('id', 'in', parent.purchase_dn_ids)]"/>
                <field name="dn_lot_id" string="From Lot" attrs="{'column_invisible': [('parent.picking_code', '!=', 'internal')]}"/>
                <!-- <field name="dn_lot_id" invisible="1"/> -->
            </field>
            <field name="lot_name" position="before">
                <field name="truck_id" invisible="1" force_save="1"/>
                <field name="cartoon_id" domain="[('truck_id', '=', truck_id)]" attrs="{'required': [('parent.is_return_order', '=', False)], 'column_invisible': [('parent.is_return_order', '=', True)]}"/>
                <field name="available_lot_qty" attrs="{'column_invisible': [('parent.picking_code', '=', 'incoming')]}"/>
            </field>
<!--             <field name="lot_id" position="attributes">
                <attribute name="domain">[('id', 'in', [])]</attribute>
            </field> -->
        </field>
    </record>
</odoo>
